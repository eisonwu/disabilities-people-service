import{B as e,C as t,D as n,E as r,H as i,L as a,O as o,P as s,T as c,b as l,j as u,k as d,w as f}from"./index-ZxwZ-DFU.js";import{l as p}from"./api-CwVXzD2M.js";var m=i(e(((e,t)=>{(function(n,r){typeof e==`object`&&t!==void 0?t.exports=r():typeof define==`function`&&define.amd?define(r):(n||=self,n.AMapLoader=r())})(e,function(){function e(e){var r=[];return e.AMapUI&&r.push(t(e.AMapUI)),e.Loca&&r.push(n(e.Loca)),Promise.all(r)}function t(e){return new Promise(function(t,n){var s=[];if(e.plugins)for(var c=0;c<e.plugins.length;c+=1)i.AMapUI.plugins.indexOf(e.plugins[c])==-1&&s.push(e.plugins[c]);if(a.AMapUI===r.failed)n(`前次请求 AMapUI 失败`);else if(a.AMapUI===r.notload){a.AMapUI=r.loading,i.AMapUI.version=e.version||i.AMapUI.version,c=i.AMapUI.version;var l=document.body||document.head,u=document.createElement(`script`);u.type=`text/javascript`,u.src=`https://webapi.amap.com/ui/`+c+`/main.js`,u.onerror=function(e){a.AMapUI=r.failed,n(`请求 AMapUI 失败`)},u.onload=function(){if(a.AMapUI=r.loaded,s.length)window.AMapUI.loadUI(s,function(){for(var e=0,n=s.length;e<n;e++){var r=s[e].split(`/`).slice(-1)[0];window.AMapUI[r]=arguments[e]}for(t();o.AMapUI.length;)o.AMapUI.splice(0,1)[0]()});else for(t();o.AMapUI.length;)o.AMapUI.splice(0,1)[0]()},l.appendChild(u)}else a.AMapUI===r.loaded?e.version&&e.version!==i.AMapUI.version?n(`不允许多个版本 AMapUI 混用`):s.length?window.AMapUI.loadUI(s,function(){for(var e=0,n=s.length;e<n;e++){var r=s[e].split(`/`).slice(-1)[0];window.AMapUI[r]=arguments[e]}t()}):t():e.version&&e.version!==i.AMapUI.version?n(`不允许多个版本 AMapUI 混用`):o.AMapUI.push(function(e){e?n(e):s.length?window.AMapUI.loadUI(s,function(){for(var e=0,n=s.length;e<n;e++){var r=s[e].split(`/`).slice(-1)[0];window.AMapUI[r]=arguments[e]}t()}):t()})})}function n(e){return new Promise(function(t,n){if(a.Loca===r.failed)n(`前次请求 Loca 失败`);else if(a.Loca===r.notload){a.Loca=r.loading,i.Loca.version=e.version||i.Loca.version;var s=i.Loca.version,c=i.AMap.version.startsWith(`2`),l=s.startsWith(`2`);if(c&&!l||!c&&l)n(`JSAPI 与 Loca 版本不对应！！`);else{c=i.key,l=document.body||document.head;var u=document.createElement(`script`);u.type=`text/javascript`,u.src=`https://webapi.amap.com/loca?v=`+s+`&key=`+c,u.onerror=function(e){a.Loca=r.failed,n(`请求 AMapUI 失败`)},u.onload=function(){for(a.Loca=r.loaded,t();o.Loca.length;)o.Loca.splice(0,1)[0]()},l.appendChild(u)}}else a.Loca===r.loaded?e.version&&e.version!==i.Loca.version?n(`不允许多个版本 Loca 混用`):t():e.version&&e.version!==i.Loca.version?n(`不允许多个版本 Loca 混用`):o.Loca.push(function(e){e?n(e):n()})})}if(!window)throw Error(`AMap JSAPI can only be used in Browser.`);var r;(function(e){e.notload=`notload`,e.loading=`loading`,e.loaded=`loaded`,e.failed=`failed`})(r||={});var i={key:``,AMap:{version:`1.4.15`,plugins:[]},AMapUI:{version:`1.1`,plugins:[]},Loca:{version:`1.3.2`}},a={AMap:r.notload,AMapUI:r.notload,Loca:r.notload},o={AMap:[],AMapUI:[],Loca:[]},s=[],c=function(e){typeof e==`function`&&(a.AMap===r.loaded?e(window.AMap):s.push(e))};return{load:function(t){return new Promise(function(n,o){if(a.AMap==r.failed)o(``);else if(a.AMap==r.notload){var l=t.key,u=t.version,d=t.plugins;l?(window.AMap&&location.host!==`lbs.amap.com`&&o(`禁止多种API加载方式混用`),i.key=l,i.AMap.version=u||i.AMap.version,i.AMap.plugins=d||i.AMap.plugins,a.AMap=r.loading,u=document.body||document.head,window.___onAPILoaded=function(i){if(delete window.___onAPILoaded,i)a.AMap=r.failed,o(i);else for(a.AMap=r.loaded,e(t).then(function(){n(window.AMap)}).catch(o);s.length;)s.splice(0,1)[0]()},d=document.createElement(`script`),d.type=`text/javascript`,d.src=`https://webapi.amap.com/maps?callback=___onAPILoaded&v=`+i.AMap.version+`&key=`+l+`&plugin=`+i.AMap.plugins.join(`,`),d.onerror=function(e){a.AMap=r.failed,o(e)},u.appendChild(d)):o(`请填写key`)}else if(a.AMap==r.loaded)if(t.key&&t.key!==i.key)o(`多个不一致的 key`);else if(t.version&&t.version!==i.AMap.version)o(`不允许多个版本 JSAPI 混用`);else{if(l=[],t.plugins)for(u=0;u<t.plugins.length;u+=1)i.AMap.plugins.indexOf(t.plugins[u])==-1&&l.push(t.plugins[u]);l.length?window.AMap.plugin(l,function(){e(t).then(function(){n(window.AMap)}).catch(o)}):e(t).then(function(){n(window.AMap)}).catch(o)}else if(t.key&&t.key!==i.key)o(`多个不一致的 key`);else if(t.version&&t.version!==i.AMap.version)o(`不允许多个版本 JSAPI 混用`);else{var f=[];if(t.plugins)for(u=0;u<t.plugins.length;u+=1)i.AMap.plugins.indexOf(t.plugins[u])==-1&&f.push(t.plugins[u]);c(function(){f.length?window.AMap.plugin(f,function(){e(t).then(function(){n(window.AMap)}).catch(o)}):e(t).then(function(){n(window.AMap)}).catch(o)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,i={key:``,AMap:{version:`1.4.15`,plugins:[]},AMapUI:{version:`1.1`,plugins:[]},Loca:{version:`1.3.2`}},a={AMap:r.notload,AMapUI:r.notload,Loca:r.notload},o={AMap:[],AMapUI:[],Loca:[]}}}})}))(),1);function h(e){return e.map((e,t)=>({lnglat:[e.lng,e.lat],district:`汕头`,zone:`z${t}`,name:e.name,abnormal:e.abnormal}))}async function g(e){window._AMapSecurityConfig={securityJsCode:`95323649de480b605e3793108abb24ba`};let t=await m.default.load({key:`a9379492eec573b32e9970f35d667712`,version:`2.0`}),n=new t.Map(e.container,{mapStyle:`amap://styles/whitesmoke`,viewMode:`2D`,zoom:11,resizeEnable:!0});t.plugin(`AMap.DistrictSearch`,()=>{new t.DistrictSearch({extensions:`all`,level:`district`}).search(e.adcode,(e,r)=>{if(e!==`complete`||!r?.districtList?.[0])return;let i=r.districtList[0];i.center&&n.setCenter([i.center.lng,i.center.lat]);let a=i.boundaries;if(a?.length){let e=[];a.forEach(r=>{let i=r.split(`;`).map(e=>{let[t,n]=e.split(`,`).map(Number);return[t,n]}),a=new t.Polygon({path:i});e.push(a),n.add(a)}),n.setFitView(e,!1,[20,20,20,20]),e.forEach(e=>n.remove(e))}})}),t.plugin([`AMap.Scale`,`AMap.ToolBar`],()=>{let e=new t.Scale,r=new t.ToolBar;n.addControl(e),n.addControl(r)}),t.plugin(`AMap.DistrictLayer`,()=>{new t.DistrictLayer.Province({adcode:e.adcode,depth:2,styles:{"city-stroke":`red`,"county-stroke":`#7dd3fc`,"stroke-width":3,fill:()=>`transparent`}}).setMap(n)});let r=h(await p());return t.plugin(`AMap.IndexCluster`,()=>{let e={district:{minZoom:2,maxZoom:10},zone:{minZoom:10,maxZoom:22}},i=[`rgba(8,60,156,.85)`,`rgba(66,130,198,.85)`,`rgba(107,174,214,.85)`,`rgba(78,200,211,.85)`],a=[`rgb(8,60,156)`,`rgb(66,130,198)`,`rgb(107,174,214)`,`rgb(78,200,211)`];new t.IndexCluster(n,r,{clusterIndexSet:e,renderClusterMarker:e=>{let t=e.count,n=t===1,o=e.clusterData?.[0]??e.data?.[0],s=n&&o?.abnormal,c=n?o?.name??``:``,l=e.marker;if(n){let e=s?`#dc2626`:`#2563eb`,t=s?`#b91c1c`:`#1d4ed8`,n=document.createElement(`div`);n.className=`amap-cluster amap-cluster--single`,n.style.cssText=[`display:flex;align-items:center;gap:6px;padding:4px 8px;border-radius:16px;`,`background:linear-gradient(180deg,#fff 0%,#f1f5f9 100%);`,`border:1px solid `+t+`;box-shadow:0 2px 8px rgba(0,0,0,.15);`,`font-size:12px;color:#334155;white-space:nowrap;max-width:160px;overflow:hidden;text-overflow:ellipsis;`].join(` `);let r=document.createElement(`span`);if(r.style.cssText=`width:10px;height:10px;border-radius:50%;background:`+e+`;border:2px solid #fff;box-shadow:0 0 0 1px `+t+`;flex-shrink:0;`,n.appendChild(r),c){let e=document.createElement(`span`);e.textContent=c,e.style.fontWeight=`500`,n.appendChild(e)}l.setContent(n),l.setAnchor(`center`);return}let u=t<=5?0:t<=20?1:t<=60?2:3,d=i[u],f=a[u],p=Math.round(36+Math.min(t/r.length,1)**.3*44),m=document.createElement(`div`);m.className=`amap-cluster`,m.style.cssText=[`display:flex;flex-direction:column;align-items:center;justify-content:center;`,`width:`+p+`px;height:`+p+`px;border-radius:50%;`,`background:`+d+`;border:2px solid `+f+`;`,`color:#fff;font-size:13px;font-weight:bold;box-shadow:0 2px 10px rgba(0,0,0,.25);box-sizing:border-box;`].join(` `),m.textContent=String(t),l.setContent(m),l.setAnchor(`center`)}})}),{map:n,destroy(){n.destroy()}}}var _=r({__name:`index`,setup(e){let r=a(null),i=a(null);return o(async()=>{if(!r.value){console.error(`mapContainer.value is missing`);return}i.value=await g({container:r.value,ad:`汕头市`,adcode:`440513`})}),n(()=>{i.value&&i.value.destroy()}),(e,n)=>(d(),t(`div`,{ref_key:`mapContainer`,ref:r,style:{height:`100%`}},null,512))}}),v={class:`monitor-map-page`},y={class:`toolbar`},b={class:`map-container`},x=r({__name:`index`,setup(e){let n=a(!1);return(e,r)=>{let i=u(`el-switch`),a=u(`el-form-item`),o=u(`el-button`),p=u(`el-form`);return d(),t(`div`,v,[l(`div`,y,[c(p,{inline:``},{default:s(()=>[c(a,{label:`异常设备`},{default:s(()=>[c(i,{modelValue:n.value,"onUpdate:modelValue":r[0]||=e=>n.value=e},null,8,[`modelValue`])]),_:1}),c(a,null,{default:s(()=>[c(o,{type:`primary`},{default:s(()=>[...r[1]||=[f(`筛选`,-1)]]),_:1})]),_:1})]),_:1})]),l(`div`,b,[c(_)])])}}});export{x as default};