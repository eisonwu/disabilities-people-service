import{C as e,D as t,E as n,H as r,L as i,O as a,P as o,T as s,b as c,i as l,j as u,k as d,w as f}from"./index-ZxwZ-DFU.js";import{t as p}from"./api-CwVXzD2M.js";import{t as m}from"./echarts-0wnlM3u_.js";var h={class:`stats-report-page`},g={class:`toolbar`},_={class:`toolbar-left`},v={class:`toolbar-right`},y={class:`chart-row`},b=n({__name:`index`,setup(n){let r=i(null),b=i(!1),x=i(null),S=i(null),C=i(null),w=i(null),T=i(null),E=null,D=null,O=null,k=null,A={left:`3%`,right:`4%`,bottom:`15%`,top:`12%`,containLabel:!0};function j(e,t){S.value&&(E?.dispose(),E=m(S.value),E.setOption({tooltip:{trigger:`axis`},legend:{data:t.map(e=>e.name),bottom:0},grid:A,xAxis:{type:`category`,data:e},yAxis:[{type:`value`,name:`新增`},{type:`value`,name:`累计`}],series:t.map((e,t)=>({name:e.name,type:e.type,smooth:e.smooth,data:e.data,itemStyle:e.itemStyle,yAxisIndex:e.name===`累计人数`?1:0}))}))}function M(e,t){C.value&&(D?.dispose(),D=m(C.value),D.setOption({tooltip:{trigger:`axis`},legend:{data:t.map(e=>e.name),bottom:0},grid:A,xAxis:{type:`category`,data:e},yAxis:{type:`value`},series:t.map(e=>({name:e.name,type:`line`,smooth:e.smooth,data:e.data,itemStyle:e.itemStyle}))}))}function N(e){w.value&&(O?.dispose(),O=m(w.value),O.setOption({tooltip:{trigger:`item`},legend:{orient:`vertical`,right:10,top:`center`},series:[{type:`pie`,radius:[`40%`,`65%`],center:[`40%`,`50%`],data:e,label:{show:!0,formatter:`{b}: {c}`},itemStyle:{borderRadius:6,borderColor:`#fff`,borderWidth:2},color:[`#f59e0b`,`#ef4444`,`#8b5cf6`,`#06b6d4`]}]}))}function P(e,t){T.value&&(k?.dispose(),k=m(T.value),k.setOption({tooltip:{trigger:`axis`},legend:{data:t.map(e=>e.name),bottom:0},grid:A,xAxis:{type:`category`,data:e},yAxis:{type:`value`,name:`次数`},series:t.map(e=>({name:e.name,type:`bar`,data:e.data,itemStyle:e.itemStyle}))}))}function F(){E?.resize(),D?.resize(),O?.resize(),k?.resize()}async function I(){b.value=!0;try{let e=await p(r.value?{startDate:r.value[0],endDate:r.value[1]}:void 0);x.value=e,j(e.archive.chart.xAxis,e.archive.chart.series),M(e.alert.chart.xAxis,e.alert.chart.series),N(e.alert.pie),P(e.service.chart.xAxis,e.service.chart.series)}finally{b.value=!1}}function L(){l.info(`导出功能待对接（可接入 xlsx 等库）`)}return a(()=>{I(),window.addEventListener(`resize`,F)}),t(()=>{window.removeEventListener(`resize`,F),E?.dispose(),D?.dispose(),O?.dispose(),k?.dispose()}),(t,n)=>{let i=u(`el-date-picker`),a=u(`el-form-item`),l=u(`el-button`),p=u(`el-form`),m=u(`el-table-column`),E=u(`el-table`),D=u(`el-card`);return d(),e(`div`,h,[c(`div`,g,[c(`div`,_,[s(p,{inline:``},{default:o(()=>[s(a,{label:`时间段`},{default:o(()=>[s(i,{modelValue:r.value,"onUpdate:modelValue":n[0]||=e=>r.value=e,type:`daterange`,"range-separator":`至`,"start-placeholder":`开始日期`,"end-placeholder":`结束日期`,"value-format":`YYYY-MM-DD`,style:{width:`240px`}},null,8,[`modelValue`])]),_:1}),s(a,null,{default:o(()=>[s(l,{type:`primary`,loading:b.value,onClick:I},{default:o(()=>[...n[1]||=[f(`查询`,-1)]]),_:1},8,[`loading`])]),_:1})]),_:1})]),c(`div`,v,[s(l,{type:`success`,onClick:L},{default:o(()=>[...n[2]||=[f(`导出 Excel`,-1)]]),_:1})])]),s(D,{class:`report-card`,shadow:`hover`},{header:o(()=>[...n[3]||=[c(`span`,{class:`card-title`},`残疾人入档统计`,-1)]]),default:o(()=>[s(E,{data:x.value?.archive?.table??[],stripe:``,border:``,"max-height":`220`},{default:o(()=>[s(m,{prop:`period`,label:`统计周期`,width:`110`}),s(m,{prop:`district`,label:`辖区`,width:`100`}),s(m,{prop:`newCount`,label:`新增入档`,width:`100`,align:`right`}),s(m,{prop:`totalCount`,label:`累计人数`,align:`right`})]),_:1},8,[`data`]),c(`div`,{ref_key:`archiveChartRef`,ref:S,class:`report-chart`},null,512)]),_:1}),s(D,{class:`report-card`,shadow:`hover`},{header:o(()=>[...n[4]||=[c(`span`,{class:`card-title`},`预警统计`,-1)]]),default:o(()=>[s(E,{data:x.value?.alert?.table??[],stripe:``,border:``,"max-height":`220`},{default:o(()=>[s(m,{prop:`type`,label:`预警类型`,width:`120`}),s(m,{prop:`level`,label:`级别`,width:`80`}),s(m,{prop:`count`,label:`数量`,width:`100`,align:`right`}),s(m,{prop:`period`,label:`统计周期`})]),_:1},8,[`data`]),c(`div`,y,[c(`div`,{ref_key:`alertChartRef`,ref:C,class:`report-chart report-chart--half`},null,512),c(`div`,{ref_key:`alertPieRef`,ref:w,class:`report-chart report-chart--half`},null,512)])]),_:1}),s(D,{class:`report-card`,shadow:`hover`},{header:o(()=>[...n[5]||=[c(`span`,{class:`card-title`},`服务统计`,-1)]]),default:o(()=>[s(E,{data:x.value?.service?.table??[],stripe:``,border:``,"max-height":`220`},{default:o(()=>[s(m,{prop:`serviceType`,label:`服务类型`,width:`120`}),s(m,{prop:`count`,label:`服务次数`,width:`100`,align:`right`}),s(m,{prop:`period`,label:`统计周期`})]),_:1},8,[`data`]),c(`div`,{ref_key:`serviceChartRef`,ref:T,class:`report-chart`},null,512)]),_:1})])}}});export{b as default};